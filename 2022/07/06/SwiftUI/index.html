<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>SwiftUI 从入门到放弃 | 我的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="什么是SwiftUISwiftUI 于 2019 年度 WWDC 全球开发者大会上发布，它是基于 Swift 建立的声明式UI框架。 该框架可以用于 watchOS、tvOS、macOS、iOS 等平台的应用开发，等于说统一了苹果生态圈的开发工具。  SwiftUI provides views, controls, and layout structures for declaring you">
<meta property="og:type" content="article">
<meta property="og:title" content="SwiftUI 从入门到放弃">
<meta property="og:url" content="https://zcx4u.github.io/2022/07/06/SwiftUI/index.html">
<meta property="og:site_name" content="我的博客">
<meta property="og:description" content="什么是SwiftUISwiftUI 于 2019 年度 WWDC 全球开发者大会上发布，它是基于 Swift 建立的声明式UI框架。 该框架可以用于 watchOS、tvOS、macOS、iOS 等平台的应用开发，等于说统一了苹果生态圈的开发工具。  SwiftUI provides views, controls, and layout structures for declaring you">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.zcx.info/e6c9d24ely1h4461xrrg2j211906rjrv.jpg">
<meta property="og:image" content="https://cdn.zcx.info/e6c9d24ely1h36ny2yym8j213002fmx4.jpg">
<meta property="og:image" content="https://cdn.zcx.info/e6c9d24ely1h36o3x0gvgj207h04lglm.jpg">
<meta property="og:image" content="https://cdn.zcx.info/e6c9d24ely1h3x76m90gnj20b80buglq.jpg">
<meta property="og:image" content="https://docs-assets.developer.apple.com/published/d98251c2fac9fc4f6843be1e4836cb93/Managing-User-Interface-State-1@2x.png">
<meta property="article:published_time" content="2022-07-05T16:00:00.000Z">
<meta property="article:modified_time" content="2025-03-13T09:54:06.212Z">
<meta property="article:author" content="bruin">
<meta property="article:tag" content="学习笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.zcx.info/e6c9d24ely1h4461xrrg2j211906rjrv.jpg">
  
    <link rel="alternate" href="/atom.xml" title="我的博客" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/images/banner.webp" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>我的博客 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS 订阅">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS 订阅">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/images/bruin.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">bruin </div>
      <div class="dot"></div>
      <div class="subtitle">个人技术博客 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/zcx4u" title="GitHub"><i class="fa-brands fa-github"></i></a>
        
          <a class="link-btn" href="mailto:your-email@example.com" title="Email"><i class="fa-solid fa-envelope"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分类</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/iOS/">
                iOS
                <div class="category-count">20</div>
            </a>
        
            <a class="category-link" href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/">
                软件工程
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/%E6%8A%80%E6%9C%AF/">
                技术
                <div class="category-count">5</div>
            </a>
        
            <a class="category-link" href="/categories/ios-development/">
                iOS开发
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/tech-sharing/">
                技术分享
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/">
                工程实践
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">标签</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AIGC/" rel="tag">AIGC</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/BUG%E8%AE%B0%E5%BD%95%E5%92%8C%E7%BB%8F%E9%AA%8C%E6%94%B6%E9%9B%86/" rel="tag">BUG记录和经验收集</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ChatGPT/" rel="tag">ChatGPT</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Xcode/" rel="tag">Xcode</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/asr/" rel="tag">asr</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/i18n/" rel="tag">i18n</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ios/" rel="tag">iOS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E4%B8%80%E9%94%AE%E5%94%A4%E8%B5%B7/" rel="tag">一键唤起</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5/" rel="tag">代码审查</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7/" rel="tag">可观测性</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" rel="tag">图像处理</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%A4%9A%E8%AF%BB%E6%96%87%E6%A1%A3/" rel="tag">多读文档</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E5%BE%84/" rel="tag">学习路径</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%B0%8F%E7%BB%84%E4%BB%B6/" rel="tag">小组件</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" rel="tag">开发工具</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/" rel="tag">开发流程</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/performance/" rel="tag">性能优化</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF%E8%B0%83%E7%A0%94/" rel="tag">技术调研</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E6%95%88%E7%8E%87/" rel="tag">效率</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/" rel="tag">日志系统</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/best-practices/" rel="tag">最佳实践</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E6%9C%89%E7%94%A8%E7%9A%84/" rel="tag">有用的</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/architecture/" rel="tag">架构设计</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E7%9F%A5%E8%AF%86%E7%82%B9/" rel="tag">知识点</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mobile-dev/" rel="tag">移动开发</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E7%BB%8F%E9%AA%8C%E8%AE%B0%E5%BD%95/" rel="tag">经验记录</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E8%81%8C%E4%B8%9A%E5%8F%91%E5%B1%95/" rel="tag">职业发展</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB/" rel="tag">语音识别</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E8%B0%83%E8%AF%95/" rel="tag">调试</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/" rel="tag">错误处理</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">归档</h3>
      
      
        <a class="archive-link" href="/archives/2025/03 ">
          三月 2025 
          <div class="archive-count">7 </div>
        </a>
      
        <a class="archive-link" href="/archives/2024/11 ">
          十一月 2024 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2024/05 ">
          五月 2024 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2024/01 ">
          一月 2024 
          <div class="archive-count">4 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/11 ">
          十一月 2022 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/07 ">
          七月 2022 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/02 ">
          二月 2022 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2021/12 ">
          十二月 2021 
          <div class="archive-count">2 </div>
        </a>
      
        <a class="archive-link" href="/archives/2021/09 ">
          九月 2021 
          <div class="archive-count">2 </div>
        </a>
      
        <a class="archive-link" href="/archives/2021/08 ">
          八月 2021 
          <div class="archive-count">3 </div>
        </a>
      
        <a class="archive-link" href="/archives/2021/04 ">
          四月 2021 
          <div class="archive-count">2 </div>
        </a>
      
        <a class="archive-link" href="/archives/2021/02 ">
          二月 2021 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2021/01 ">
          一月 2021 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2020/09 ">
          九月 2020 
          <div class="archive-count">3 </div>
        </a>
      
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">最新文章</h3>
      <ul>
        
          <a class="recent-link" href="/2025/03/27/iOS-i18n%E5%8A%A8%E6%80%81%E5%8C%96%E6%80%9D%E8%80%83/" title="iOS-i18n动态化思考" >
            <div class="recent-link-text">
              iOS-i18n动态化思考
            </div>
          </a>
        
          <a class="recent-link" href="/2025/03/19/%E5%9F%BA%E4%BA%8EAI%E5%8A%A9%E6%89%8B%E7%9A%84%E5%A4%9A%E8%AF%AD%E8%A8%80%E7%BF%BB%E8%AF%91%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5/" title="基于AI助手的多语言翻译系统开发实践" >
            <div class="recent-link-text">
              基于AI助手的多语言翻译系统开发实践
            </div>
          </a>
        
          <a class="recent-link" href="/2025/03/14/CTMediator%20%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93%E4%B8%8E%E6%80%9D%E8%80%83/" title="CTMediator 架构方案深度解析" >
            <div class="recent-link-text">
              CTMediator 架构方案深度解析
            </div>
          </a>
        
          <a class="recent-link" href="/2025/03/14/CodeReview%E6%8C%87%E5%8D%97/" title="代码审查实战指南" >
            <div class="recent-link-text">
              代码审查实战指南
            </div>
          </a>
        
          <a class="recent-link" href="/2025/03/14/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%97%A5%E5%BF%97%E8%A7%84%E8%8C%83%E6%8C%87%E5%8D%97/" title="客户端日志规范指南" >
            <div class="recent-link-text">
              客户端日志规范指南
            </div>
          </a>
        
          <a class="recent-link" href="/2025/03/12/iOSCrash%E7%B1%BB%E5%9E%8B/" title="iOS Crash类型总结" >
            <div class="recent-link-text">
              iOS Crash类型总结
            </div>
          </a>
        
          <a class="recent-link" href="/2025/03/12/iOS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B%E6%8C%87%E5%8D%97/" title="iOS文件系统编程指南" >
            <div class="recent-link-text">
              iOS文件系统编程指南
            </div>
          </a>
        
          <a class="recent-link" href="/2024/11/29/iOS%E8%83%8C%E6%99%AF%E6%A8%A1%E7%B3%8A%E5%AE%9E%E7%8E%B0%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88/" title="AI作业背景模糊实现技术方案" >
            <div class="recent-link-text">
              AI作业背景模糊实现技术方案
            </div>
          </a>
        
          <a class="recent-link" href="/2024/05/20/iOS%E7%AB%AF%20ASR%E4%BC%98%E5%8C%96/" title="iOS端 ASR优化" >
            <div class="recent-link-text">
              iOS端 ASR优化
            </div>
          </a>
        
          <a class="recent-link" href="/2024/01/15/ChatGPT%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%89%8B%E5%86%8C/" title="ChatGPT使用技巧手册" >
            <div class="recent-link-text">
              ChatGPT使用技巧手册
            </div>
          </a>
        
          <a class="recent-link" href="/2024/01/01/%E7%AE%97%E6%B3%95/" title="常见算法考题列表（2025 年整理）" >
            <div class="recent-link-text">
              常见算法考题列表（2025 年整理）
            </div>
          </a>
        
          <a class="recent-link" href="/2024/01/01/%E9%AB%98%E9%A2%91%E9%97%AE%E9%A2%98/" title="iOS 面试高频问题总结（2025 最新版）" >
            <div class="recent-link-text">
              iOS 面试高频问题总结（2025 最新版）
            </div>
          </a>
        
          <a class="recent-link" href="/2024/01/01/%E6%8A%80%E6%9C%AF%E8%B7%AF%E7%BA%BF%E5%9B%BE/" title="iOS 开发者技术路线图（2025 年）" >
            <div class="recent-link-text">
              iOS 开发者技术路线图（2025 年）
            </div>
          </a>
        
          <a class="recent-link" href="/2022/11/05/iOS%E7%AD%BE%E5%90%8D%E6%9C%BA%E5%88%B6/" title="iOS签名机制" >
            <div class="recent-link-text">
              iOS签名机制
            </div>
          </a>
        
          <a class="recent-link" href="/2022/07/06/SwiftUI/" title="SwiftUI 从入门到放弃" >
            <div class="recent-link-text">
              SwiftUI 从入门到放弃
            </div>
          </a>
        
          <a class="recent-link" href="/2022/02/28/XCUITest%E6%8E%A2%E7%B4%A2/" title="XCUITest iOS自动化UI测试框架" >
            <div class="recent-link-text">
              XCUITest iOS自动化UI测试框架
            </div>
          </a>
        
          <a class="recent-link" href="/2021/12/06/iOS%20Web%E5%94%A4%E8%B5%B7APP%E6%96%B9%E6%A1%88%E5%8F%82%E8%80%83/" title="iOS 一键唤起APP方案参考" >
            <div class="recent-link-text">
              iOS 一键唤起APP方案参考
            </div>
          </a>
        
          <a class="recent-link" href="/2021/12/06/%E4%BF%A1%E6%81%AF%E6%B5%81GIF%E8%BD%AE%E6%92%AD%E6%A1%86%E6%9E%B6/" title="iOS 如何做一个九宫格GIF播放器" >
            <div class="recent-link-text">
              iOS 如何做一个九宫格GIF播放器
            </div>
          </a>
        
          <a class="recent-link" href="/2021/09/18/iOS%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88%E6%8E%A2%E7%B4%A2%E4%B8%8E%E5%AE%9E%E8%B7%B5-%E7%BB%84%E4%BB%B6%E7%AF%87/" title="iOS编译优化方案探索与实践-组件篇" >
            <div class="recent-link-text">
              iOS编译优化方案探索与实践-组件篇
            </div>
          </a>
        
          <a class="recent-link" href="/2021/09/09/module-importing%20failed-invalid%20pathname/" title="module importing failed invalid pathname 问题解决" >
            <div class="recent-link-text">
              module importing failed invalid pathname 问题解决
            </div>
          </a>
        
          <a class="recent-link" href="/2021/08/31/iOS-OCR%E5%AE%9E%E8%B7%B5/" title="iOS-OCR实践" >
            <div class="recent-link-text">
              iOS-OCR实践
            </div>
          </a>
        
          <a class="recent-link" href="/2021/08/25/AVPlayer%E7%9B%B8%E5%85%B3BUG%E8%AE%B0%E5%BD%95/" title="AVPlayer相关BUG记录" >
            <div class="recent-link-text">
              AVPlayer相关BUG记录
            </div>
          </a>
        
          <a class="recent-link" href="/2021/08/25/Xcode%E4%BB%A3%E7%A0%81%E5%9D%97%E4%BA%91%E5%90%8C%E6%AD%A5+%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC/" title="Xcode代码块云同步+本地安装脚本" >
            <div class="recent-link-text">
              Xcode代码块云同步+本地安装脚本
            </div>
          </a>
        
          <a class="recent-link" href="/2021/04/22/iOS%E5%AD%97%E7%AC%A6%E5%92%8C%E5%AD%97%E7%B4%A0%E7%B0%87/" title="iOS字符串安全截取及任意位置插入" >
            <div class="recent-link-text">
              iOS字符串安全截取及任意位置插入
            </div>
          </a>
        
          <a class="recent-link" href="/2021/04/20/NSCache/" title="NSCache" >
            <div class="recent-link-text">
              NSCache
            </div>
          </a>
        
          <a class="recent-link" href="/2021/02/23/%E4%B8%80%E5%B8%96%E7%9C%8B%E9%80%8FiOS14%20%E5%B0%8F%E7%BB%84%E4%BB%B6/" title="一帖看透iOS14 小组件" >
            <div class="recent-link-text">
              一帖看透iOS14 小组件
            </div>
          </a>
        
          <a class="recent-link" href="/2021/01/18/APP%E4%BB%A3%E7%90%86/" title="APP内部代理" >
            <div class="recent-link-text">
              APP内部代理
            </div>
          </a>
        
          <a class="recent-link" href="/2020/09/25/runloop/" title="runloop 学习笔记" >
            <div class="recent-link-text">
              runloop 学习笔记
            </div>
          </a>
        
          <a class="recent-link" href="/2020/09/23/block/" title="__block 关键字探究" >
            <div class="recent-link-text">
              __block 关键字探究
            </div>
          </a>
        
          <a class="recent-link" href="/2020/09/22/GCD/" title="GCD相关知识学习笔记" >
            <div class="recent-link-text">
              GCD相关知识学习笔记
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-SwiftUI" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        SwiftUI 从入门到放弃
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2022-07-05T16:00:00.000Z" itemprop="datePublished">2022-07-06</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/iOS/">iOS</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            25k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p><img src="https://cdn.zcx.info/e6c9d24ely1h4461xrrg2j211906rjrv.jpg" alt="SWiftUITitleImage"></p>
<h2 id="什么是SwiftUI"><a href="#什么是SwiftUI" class="headerlink" title="什么是SwiftUI"></a>什么是SwiftUI</h2><p>SwiftUI 于 2019 年度 WWDC 全球开发者大会上发布，它是基于 Swift 建立的声明式UI框架。</p>
<p>该框架可以用于 watchOS、tvOS、macOS、iOS 等平台的应用开发，等于说统一了苹果生态圈的开发工具。</p>
<blockquote>
<p>SwiftUI provides views, controls, and layout structures for declaring your app’s user interface. The framework provides event handlers for delivering taps, gestures, and other types of input to your app, and tools to manage the flow of data from your app’s models down to the views and controls that users will see and interact with.</p>
</blockquote>
<h2 id="SwiftUI-Hello-World"><a href="#SwiftUI-Hello-World" class="headerlink" title="SwiftUI Hello World"></a>SwiftUI Hello World</h2><p><a target="_blank" rel="noopener" href="https://developer.apple.com/tutorials/swiftui/creating-and-combining-views">创建新项目并预览画布</a></p>
<p>和平时创建新项目流程基本一致。只需要选择Swift UI Interface即可。</p>
<p><img src="https://cdn.zcx.info/e6c9d24ely1h36ny2yym8j213002fmx4.jpg" alt="2"></p>
<p>工程初始化创建完毕后可以看到文件结构如下：</p>
<p><img src="https://cdn.zcx.info/e6c9d24ely1h36o3x0gvgj207h04lglm.jpg" alt="3"></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── <span class="title class_">SwiftUIClient</span></span><br><span class="line">│   ├── <span class="title class_">Assets</span>.xcassets /<span class="regexp">/ 素材文件夹</span></span><br><span class="line"><span class="regexp">│   │   ├── AccentColor.colorset</span></span><br><span class="line"><span class="regexp">│   │   │   └── Contents.json</span></span><br><span class="line"><span class="regexp">│   │   ├── AppIcon.appiconset</span></span><br><span class="line"><span class="regexp">│   │   │   └── Contents.json</span></span><br><span class="line"><span class="regexp">│   │   └── Contents.json</span></span><br><span class="line"><span class="regexp">│   ├── ContentView.swift /</span><span class="regexp">/ 默认view</span></span><br><span class="line"><span class="regexp">│   ├── Preview Content</span></span><br><span class="line"><span class="regexp">│   │   └── Preview Assets.xcassets</span></span><br><span class="line"><span class="regexp">│   │       └── Contents.json</span></span><br><span class="line"><span class="regexp">│   └── SwiftUIClientApp.swift /</span><span class="regexp">/ APP入口文件</span></span><br><span class="line"><span class="regexp">└── SwiftUIClient.xcodeproj </span></span><br><span class="line"><span class="regexp">    ├── project.pbxproj</span></span><br><span class="line"><span class="regexp">    └── xcuserdata</span></span><br><span class="line"><span class="regexp">        └── pxcm-0101-01-0246.xcuserdatad</span></span><br><span class="line"><span class="regexp">            └── xcschemes</span></span><br><span class="line"><span class="regexp">                └── xcschememanagement.plist</span></span><br></pre></td></tr></table></figure>

<h2 id="main"><a href="#main" class="headerlink" title="@main"></a>@main</h2><p>找到APP入口文件<code>SwiftUIClientApp.swift</code>中的<code>@main</code>标记<br>根据经验APP会从@main入口启动开始执行</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SwiftUIClientApp</span>: <span class="title class_ inherited__">App</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="type">WindowGroup</span> &#123;</span><br><span class="line">            <span class="type">ContentView</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们会遇到三个新的结构: App, Scene, WindowGroup</p>
<h3 id="App-Protocol"><a href="#App-Protocol" class="headerlink" title="App Protocol"></a>App Protocol</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@available</span>(<span class="keyword">iOS</span> <span class="number">14.0</span>, <span class="keyword">macOS</span> <span class="number">11.0</span>, <span class="keyword">tvOS</span> <span class="number">14.0</span>, <span class="keyword">watchOS</span> <span class="number">7.0</span>, <span class="operator">*</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">App</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过声明符合<code>App</code>协议的结构来创建应用程序。实现所需的<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/app/body-swift.property"><code>body</code></a>计算属性来定义应用程序的内容。</p>
<p>在结构声明之前加上<a target="_blank" rel="noopener" href="https://docs.swift.org/swift-book/ReferenceManual/Attributes.html#ID626">@main</a>属性，表明您的自定义<code>App</code>协议符合者提供了应用程序的入口点。<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/app/main()"><code>main()</code></a>该协议提供了系统调用以启动您的应用程序的方法的默认实现。在所有应用程序文件中只可以有一个入口点。</p>
<p>可以简单理解为APP的外壳&#x2F;容器</p>
<h3 id="Scene-Protocol"><a href="#Scene-Protocol" class="headerlink" title="Scene Protocol"></a>Scene Protocol</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@available</span>(<span class="keyword">iOS</span> <span class="number">14.0</span>, <span class="keyword">macOS</span> <span class="number">11.0</span>, <span class="keyword">tvOS</span> <span class="number">14.0</span>, <span class="keyword">watchOS</span> <span class="number">7.0</span>, <span class="operator">*</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">Scene</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您可以<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/app"><code>App</code></a>通过组合一个或多个符合<code>Scene</code>应用程序中协议的实例来创建<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/app/body-swift.property"><code>body</code></a>. 您可以使用 SwiftUI 提供的内置场景，例如，以及您从其他场景中组合的自定义场景。要创建自定义场景，请声明符合协议的类型。实现所需的计算属性并为您的自定义场景提供内容：<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/windowgroup"><code>WindowGroup</code></a><code>Scene</code><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/scene/body-swift.property"><code>body</code></a></p>
<p>场景是视图（View）层次结构的容器。通过在App实例的body中组合一个或多个符合Scene协议的实例来呈现具体程序。</p>
<ul>
<li>生命周期由系统管理</li>
<li>系统会根据运行平台的不同而调整场景的展示行为（比如相同的代码在iOS和macOS下的呈现不同，或者某些场景仅能运行于特定的平台）</li>
<li>SwiftUI2.0提供了几个预置的场景，用户也可以自己编写符合Scene协议的场景。上述代码中便是使用的一个预置场景WindowGroup</li>
</ul>
<p>可以简单理解为多窗口模式下的某一个窗口(iPad&#x2F;Mac)</p>
<h3 id="WindowGroup-Struct"><a href="#WindowGroup-Struct" class="headerlink" title="WindowGroup Struct"></a>WindowGroup Struct</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@available</span>(<span class="keyword">iOS</span> <span class="number">14.0</span>, <span class="keyword">macOS</span> <span class="number">11.0</span>, <span class="keyword">tvOS</span> <span class="number">14.0</span>, <span class="keyword">watchOS</span> <span class="number">7.0</span>, <span class="operator">*</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">WindowGroup</span>&lt;<span class="type">Content</span>&gt; : <span class="type">Scene</span> <span class="keyword">where</span> <span class="type">Content</span> : <span class="type">View</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最常用的Scene，可以呈现一组结构相同的窗口。使用该场景，我们无需在代码上做修改，只需要在项目中设定是否支持多窗口，系统将会按照运行平台的特性自动管理。</p>
<p>如果在一个WindowGroup里加入多个View,呈现状态有点类似VStack。从上到下依排列</p>
<p>在一个Scene中加入多个WindowGroup，只有最前面的可以被显示。</p>
<h2 id="View-Protocol-和常用控件"><a href="#View-Protocol-和常用控件" class="headerlink" title="View Protocol 和常用控件"></a>View Protocol 和常用控件</h2><p>SwiftUI使用过程中可以明显感觉到整个APP都是使用一系列View互相嵌套&#x2F;堆叠而成的。</p>
<p>View 协议是整个UI界面的基础,提供配置界面的各个部分。</p>
<blockquote>
<p>A type that represents part of your app’s user interface and provides modifiers that you use to configure views.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">TestView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h3><h4 id="Text"><a href="#Text" class="headerlink" title="Text"></a>Text</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;我是一个设置了蓝底白字行间距5内边距5边框3的Text控件&quot;</span>)</span><br><span class="line">.lineLimit(<span class="number">2</span>)<span class="comment">// 最大2行</span></span><br><span class="line">.font(.largeTitle) <span class="comment">// 字体</span></span><br><span class="line">.foregroundColor(.white)<span class="comment">// 字体颜色</span></span><br><span class="line">.background(.blue) <span class="comment">// 背景颜色</span></span><br><span class="line">.lineSpacing(<span class="number">5</span>) <span class="comment">// 行间距</span></span><br><span class="line">.padding(.all, <span class="number">5</span>) <span class="comment">// 文字和空间间的内边距</span></span><br><span class="line">.border(.blue, width: <span class="number">3</span>)<span class="comment">// 边框</span></span><br><span class="line">.rotationEffect(<span class="type">Angle</span>(degrees: <span class="number">50</span>)) <span class="comment">// 旋转</span></span><br></pre></td></tr></table></figure>

<p>简单且强大的文本控件,类似于UILabel.可以支持很短的代码设置所需属性</p>
<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3i0g7vwrdj214w0mjacl.jpg"></image></pre>
</details>

<h4 id="TextField"><a href="#TextField" class="headerlink" title="TextField"></a>TextField</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TextField</span>(<span class="string">&quot;输入框&quot;</span>, text: <span class="variable">$value</span>)</span><br><span class="line">.textFieldStyle(.roundedBorder)</span><br><span class="line">.keyboardType(.alphabet)</span><br></pre></td></tr></table></figure>

<p>相当于UIKit中的UITextField的单行文本输入框.支持banging一个@state修饰的string变量。</p>
<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3i5s1lrouj214r0mejuw.jpg"></image></pre>
</details>

<h4 id="SecureField"><a href="#SecureField" class="headerlink" title="SecureField"></a>SecureField</h4><p>密码输入框,用法和普通的输入框一致</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SecureField</span>(<span class="string">&quot;密码输入&quot;</span>, text: <span class="variable">$value</span>)</span><br><span class="line">.textFieldStyle(.roundedBorder)</span><br><span class="line">.keyboardType(.alphabet)</span><br><span class="line">.accentColor(.red)</span><br></pre></td></tr></table></figure>

<h4 id="TextEditor"><a href="#TextEditor" class="headerlink" title="TextEditor"></a>TextEditor</h4><p>类似UITextView,多行输入文本</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TextEditor</span>(text: <span class="variable">$value</span>)</span><br><span class="line">.keyboardType(.default)</span><br><span class="line">.multilineTextAlignment(.leading)</span><br><span class="line">.accentColor(.red)</span><br><span class="line">.foregroundColor(.black)</span><br><span class="line">.background(.gray.opacity(<span class="number">0.3</span>))</span><br><span class="line">.lineSpacing(<span class="number">5</span>)</span><br><span class="line">.frame(maxHeight: <span class="number">500</span>)</span><br><span class="line">.textInputAutocapitalization(.words)</span><br><span class="line">.disableAutocorrection(<span class="literal">true</span> )</span><br><span class="line">.onChange(of: value) &#123; newValue <span class="keyword">in</span></span><br><span class="line">    textCount <span class="operator">=</span> newValue.count <span class="comment">// 输入文本变化监听器</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3i8b01bi2j214q0mg437.jpg"></image></pre>
</details>

<h3 id="按钮"><a href="#按钮" class="headerlink" title="按钮"></a>按钮</h3><h4 id="Button"><a href="#Button" class="headerlink" title="Button"></a>Button</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不带边框style的button</span></span><br><span class="line"><span class="type">Button</span>(<span class="string">&quot;不应用边框的按钮样式&quot;</span>)&#123;&#125;.buttonStyle(<span class="type">BorderlessButtonStyle</span>()).padding()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以通过自定义PrimitiveButtonStyle类来实现一些自定义的button</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PriButton</span>: <span class="title class_ inherited__">PrimitiveButtonStyle</span> &#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Body</span> <span class="operator">=</span> <span class="type">Button</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeBody</span>(<span class="params">configuration</span>: <span class="type">Configuration</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        configuration.trigger()</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">        <span class="type">Button</span>(configuration)</span><br><span class="line">            .background(<span class="type">Color</span>.orange)</span><br><span class="line">            .clipShape(<span class="type">RoundedRectangle</span>(cornerRadius: <span class="number">25.0</span>, style: .continuous))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可以直接使用label参数设置自定义view</span></span><br><span class="line"><span class="type">Button</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;click&quot;</span>) <span class="comment">// 事件block</span></span><br><span class="line">&#125; label: &#123;</span><br><span class="line">   <span class="comment">//这里可以放自定义view</span></span><br><span class="line">    <span class="type">Image</span>(systemName: <span class="string">&quot;star&quot;</span>).offset(x: <span class="operator">-</span><span class="number">10</span>, y: <span class="number">0</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;带图标的按钮&quot;</span>)</span><br><span class="line">&#125;.padding()</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3i0k7u9qvj213d0mj42p.jpg"></image></pre>
</details>

<h4 id="Menu-PullDownButton"><a href="#Menu-PullDownButton" class="headerlink" title="Menu(PullDownButton)"></a>Menu(<em>PullDownButton</em>)</h4><p>点击弹出选择菜单,可以加在toolbar上或者其他地方,本体是一个Button,也可以是自定义View.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Menu</span>(<span class="string">&quot;menu&quot;</span>) &#123;</span><br><span class="line">    <span class="type">Button</span>(<span class="string">&quot;Duplicate&quot;</span>, action: duplicate)</span><br><span class="line">    <span class="type">Button</span>(<span class="string">&quot;Rename&quot;</span>, action: rename)</span><br><span class="line">    <span class="type">Button</span>(<span class="string">&quot;Delete…&quot;</span>, action: delete)</span><br><span class="line">    <span class="type">Menu</span>(<span class="string">&quot;Copy&quot;</span>) &#123;</span><br><span class="line">        <span class="type">Button</span>(<span class="string">&quot;Copy&quot;</span>, action: <span class="keyword">copy</span>)</span><br><span class="line">        <span class="type">Button</span>(<span class="string">&quot;Copy Formatted&quot;</span>, action: copyFormatted)</span><br><span class="line">        <span class="type">Button</span>(<span class="string">&quot;Copy Library Path&quot;</span>, action: copyPath)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;.menuStyle(.borderlessButton)</span><br><span class="line"></span><br><span class="line"><span class="type">Menu</span> &#123;</span><br><span class="line">    <span class="type">Button</span>(<span class="string">&quot;Open in Preview&quot;</span>, action: openInPreview)</span><br><span class="line">    <span class="type">Button</span>(<span class="string">&quot;Save as PDF&quot;</span>, action: saveAsPDF)</span><br><span class="line">&#125; label: &#123;</span><br><span class="line">    <span class="type">Image</span>(systemName: <span class="string">&quot;document&quot;</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;PDF&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3i91gt97aj214s0mgn15.jpg"></image></pre>
</details>

<h4 id="EditButton"><a href="#EditButton" class="headerlink" title="EditButton"></a>EditButton</h4><p>支持改变整个环境变量中的editMode字段,开启编辑状态后一些系统控件会自动触发状态变化。例如支持删除或者排序的List中的ForEach列表在开启editmode后会显示出List的编辑功能。</p>
<p>当然,你也可以创建一些支持编辑模式的View,同时也可以监听环境中的editMode。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Environment</span>(\.editMode) <span class="keyword">var</span> editMode</span><br></pre></td></tr></table></figure>

<p>经常会和toolbar功能共用,在导航条右上角支持编辑模式。</p>
<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3j3vq77r8j214l0md793.jpg"></image></pre>
</details>

<h3 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h3><h4 id="List-Section-ForEach"><a href="#List-Section-ForEach" class="headerlink" title="List, Section, ForEach"></a>List, Section, ForEach</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span>&#123;</span><br><span class="line">  <span class="type">Section</span>(<span class="string">&quot;水果列表&quot;</span>) &#123;</span><br><span class="line">      <span class="type">ForEach</span>(fruits, id: \.<span class="keyword">self</span>) &#123; fruit <span class="keyword">in</span></span><br><span class="line">          <span class="type">Text</span>(<span class="string">&quot;<span class="subst">\(fruit)</span>&quot;</span>)</span><br><span class="line">      &#125;.onMove &#123; indexSet, index <span class="keyword">in</span></span><br><span class="line">          fruits.move(fromOffsets: indexSet, toOffset: index)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="operator">!</span>balls.isEmpty &#123;</span><br><span class="line">      <span class="type">Section</span>(<span class="string">&quot;球类列表&quot;</span>) &#123;</span><br><span class="line">          <span class="type">ForEach</span>(balls, id: \.<span class="keyword">self</span>) &#123; ball <span class="keyword">in</span></span><br><span class="line">              <span class="type">Text</span>(<span class="string">&quot;<span class="subst">\(ball)</span>&quot;</span>)</span><br><span class="line">          &#125;.onDelete &#123; indexSet <span class="keyword">in</span></span><br><span class="line">              balls.remove(atOffsets: indexSet)</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>List类似UIKit中的UITableView,常与ForEach语句一起使用。不像UIKit中繁琐的代理和数据源模式,List是字面含义的View列表,手动将每个VIew排列起来即可。</p>
<p>当然List也可以直接装填数据源进行列表展示</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span>(<span class="number">0</span><span class="operator">..&lt;</span><span class="number">100</span>)&#123; i <span class="keyword">in</span></span><br><span class="line">  <span class="type">Text</span>(<span class="string">&quot;id:<span class="subst">\(id)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Section则可理解为UITableView中的SectionHeader和Footer在SwiftUI中的实现.List和Section联合使用可以实现常用的多Section的tableview。</p>
<p>ForEach语句需求传入的数据拥有唯一标识,针对数组可以直接使用</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ForEach</span>(array.indices, id: \.<span class="keyword">self</span>)&#123; index <span class="keyword">in</span></span><br><span class="line"> <span class="comment">//some view</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3j3sni4zjj214s0mhtbz.jpg"></image></pre>
</details>

<h4 id="Group"><a href="#Group" class="headerlink" title="Group"></a>Group</h4><p>Group用于集合多个视图，对 Group 设置的属性，将作用于每个子视图。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Group</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">.foregroundColor(.blue)</span><br><span class="line">.font(.caption)</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3rnl7bryaj213o0metbb.jpg"></image></pre>
</details>

<h4 id="From"><a href="#From" class="headerlink" title="From"></a>From</h4><p>Form是SwiftUI的基础控件，如果我们需要显示产品配置、选项、用户输入时，使用Form可以快速搭建出各类表单。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="type">Form</span> &#123;</span><br><span class="line">    <span class="type">Section</span> &#123;</span><br><span class="line">        <span class="type">HStack</span>&#123;</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="string">&quot;star.fill&quot;</span>)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;输入的内容:<span class="subst">\(value)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">TextField</span>(<span class="string">&quot;输入框的placeholder&quot;</span>, text: <span class="variable">$value</span>)</span><br><span class="line">            .textFieldStyle(.roundedBorder)</span><br><span class="line">            .keyboardType(.alphabet)</span><br><span class="line">            .accentColor(.red)</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;一个简单的Form写法,如果我们需要显示产品配置、选项、用户输入时，使用Form可以快速搭建出各类表单,会自动增加内边距&quot;</span>)</span><br><span class="line">            .font(.caption)</span><br><span class="line">            .foregroundColor(.gray)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Section</span>(<span class="string">&quot;另一组内容&quot;</span>) &#123;</span><br><span class="line">        <span class="type">HStack</span>&#123;</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="string">&quot;star&quot;</span>)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;一个右对齐的文案&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3jl3sied0j214q0mb0w3.jpg"></image></pre>
</details>

<h4 id="ScrollView"><a href="#ScrollView" class="headerlink" title="ScrollView"></a>ScrollView</h4><p>在有限空间放较多内容的容器View</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ScrollView</span>(.vertical, showsIndicators: <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="type">ForEach</span>(list, id:\.<span class="keyword">self</span>) &#123; item <span class="keyword">in</span></span><br><span class="line">        <span class="type">Text</span>(item).padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3jbr3uhfej214s0mfjy1.jpg"></image></pre>
</details>

<h3 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h3><h4 id="VStack-HStack"><a href="#VStack-HStack" class="headerlink" title="VStack,HStack"></a>VStack,HStack</h4><p>VStack类似UIStackView,属于布局修饰符,其中包裹的view会按照一定的规则进行垂直方向的自动布局。</p>
<p>同理HStack会在水平方向自动布局,二者可叠加嵌套。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;垂直方向左对齐&quot;</span>).border(.blue, width: <span class="number">1</span>)</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;设置的两个label&quot;</span>).border(.blue, width: <span class="number">1</span>)</span><br><span class="line">    <span class="type">HStack</span>(alignment: .center, spacing: <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;嵌套一个水平方向的HStack&quot;</span>).border(.blue, width: <span class="number">1</span>)</span><br><span class="line">        <span class="type">Spacer</span>()</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;的两个label&quot;</span>).border(.blue, width: <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3uoh36i9gj213v0n1418.jpg"></image></pre>
</details>

<h4 id="ZStack"><a href="#ZStack" class="headerlink" title="ZStack"></a>ZStack</h4><p>ZStack的布局方式类似于UIKit中的View父子层级,但是SwiftUI中较少提及父子层级关系,SwiftUI中认为每个View都是独立的View,仅仅是布局方式的不同。</p>
<p>例如在UIKit中在一个View内部增加几个小View会用到addSubview方法来添加子View,但是在SwiftUI中会使用ZStack布局方式来进行View堆叠。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ZStack</span>(alignment: .center) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font></summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3uorpdw9qj213s0mtn0l.jpg"></image></pre>
</details>

<h3 id="导航"><a href="#导航" class="headerlink" title="导航"></a>导航</h3><h4 id="TabView"><a href="#TabView" class="headerlink" title="TabView"></a>TabView</h4><p>类似UIKit中的UITabbar承担tab切换的功能</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">TabType</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> featureList</span><br><span class="line">    <span class="keyword">case</span> other</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">TabView</span> &#123;</span><br><span class="line">  <span class="comment">//FeatureListHomeView是这个tabbar的root层级的view</span></span><br><span class="line">  <span class="type">FeatureListHomeView</span>().tabItem(&#123;</span><br><span class="line">      <span class="type">Label</span>(<span class="string">&quot;列表&quot;</span>, systemImage: <span class="string">&quot;list.bullet&quot;</span>)<span class="comment">// tabItem来进行展示内容</span></span><br><span class="line">  &#125;).tag(<span class="type">TabType</span>.featureList) <span class="comment">// .tag来标志映射</span></span><br><span class="line"></span><br><span class="line">  <span class="type">CustomViews</span>().tabItem(&#123;</span><br><span class="line">      <span class="type">Label</span>(<span class="string">&quot;自定义&quot;</span>, systemImage: <span class="string">&quot;star&quot;</span>)</span><br><span class="line">  &#125;).tag(<span class="type">TabType</span>.other)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3jkd4vkktj214o0men09.jpg"></image></pre>
</details>

<h4 id="NavigationView-NavigationLink"><a href="#NavigationView-NavigationLink" class="headerlink" title="NavigationView, NavigationLink"></a>NavigationView, NavigationLink</h4><p>类似UINavigationViewController,负责导航栈的管理。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NavigationView</span> &#123;</span><br><span class="line"><span class="type">List</span> &#123;</span><br><span class="line">    <span class="type">ForEach</span>(feature.demoFeatures.featureSections, id: \.<span class="keyword">self</span>) &#123; sec <span class="keyword">in</span></span><br><span class="line">        <span class="type">Section</span>(sec.featureSectionName) &#123;</span><br><span class="line">            <span class="type">ForEach</span>(sec.featureList, id: \.<span class="keyword">self</span>) &#123; item <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationLink</span> &#123;</span><br><span class="line">                    getDestinationViews(featureItem: item)</span><br><span class="line">                &#125; label: &#123;</span><br><span class="line">                    <span class="type">DemoRowView</span>(title: item.featureName, subTitle: item.featureDesc)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;.onDelete &#123; offset <span class="keyword">in</span></span><br><span class="line">                deleteRow(offset: offset, from: sec)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;.listStyle(.in<span class="keyword">set</span>)</span><br><span class="line">.navigationTitle(<span class="string">&quot;控件列表&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>一般配合NavigationLink来进行点击跳转.类似的,导航栈跳转后续的页面共用同一个导航栈。可以通过navigationTitle方法设置导航栈的标题,通过navigationBarTitleDisplayMode方法设置导航标题的展示形式。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello, World!&quot;</span>)</span><br><span class="line">.navigationTitle(<span class="string">&quot;NavigationView&quot;</span>)</span><br><span class="line">.navigationBarTitleDisplayMode(.inline)<span class="comment">// 只在顶部标题区域显示</span></span><br><span class="line">.navigationBarTitleDisplayMode(.large)<span class="comment">// 会在当前页面顶部显示一个较大的标题</span></span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3n25qldn7j214q0mg0va.jpg"></image></pre>
</details>

<h4 id="Modal"><a href="#Modal" class="headerlink" title="Modal"></a>Modal</h4><p>模态弹出是经常使用的一种弹出信息页面的模式。</p>
<p>SwiftUI给VIew增加的.sheet的扩展,给定一个绑定的值,当这个值发生变化的时候(true),触发模态框的事件。</p>
<p>UIKit中的Present VIewController不同的style,有半弹窗和全屏present</p>
<p>同理,SwiftUI给VIew增加了.fullScreenCover的扩展,给定一个绑定的值,当这个值发生变化的时候(true),触发全屏模态框的事件。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Form</span>&#123;</span><br><span class="line">  <span class="type">Button</span>(<span class="string">&quot;Modal New View&quot;</span>) &#123;</span><br><span class="line">      isPresented.toggle()</span><br><span class="line">  &#125;.sheet(isPresented: <span class="variable">$isPresented</span>, onDismiss: &#123;</span><br><span class="line">      <span class="comment">// dismiss</span></span><br><span class="line">  &#125;) &#123;</span><br><span class="line">      <span class="type">ImageDemo</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">Button</span>(<span class="string">&quot;FullScreenCover New View&quot;</span>) &#123;</span><br><span class="line">      fullScreenCover.toggle()</span><br><span class="line">  &#125;.fullScreenCover(isPresented: <span class="variable">$fullScreenCover</span>) &#123;</span><br><span class="line">      <span class="type">TextEditorDemo</span>(value: <span class="string">&quot;FullScreenCover&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3pdafcupzj213e0mgwgx.jpg"></image></pre>
</details>

<h4 id="Popover"><a href="#Popover" class="headerlink" title="Popover"></a>Popover</h4><p>Popover在不同的设备上展示会出现差异,在iOS上是模态弹出一个新页面,在iPad或Mac上弹出一个气泡框。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span>(<span class="string">&quot;Popover New View&quot;</span>) &#123;</span><br><span class="line">    popover.toggle()</span><br><span class="line">&#125;.popover(isPresented: <span class="variable">$popover</span>) &#123;</span><br><span class="line">   <span class="type">Text</span>(<span class="string">&quot;在iphone上显示为模态框弹出页面,在ipad上显示为点击气泡弹窗&quot;</span>)</span><br><span class="line">        .padding()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3ro8fw598j21380fatah.jpg"></image></pre>
</details>

<h3 id="Pickers"><a href="#Pickers" class="headerlink" title="Pickers"></a>Pickers</h3><h4 id="Picker"><a href="#Picker" class="headerlink" title="Picker"></a>Picker</h4><p>可以自定义数据的选择器</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Picker</span>(selection: <span class="variable">$selectIndex</span>) &#123;</span><br><span class="line">  <span class="type">ForEach</span>(fruits, id: \.<span class="keyword">self</span>) &#123; fruit <span class="keyword">in</span></span><br><span class="line">      <span class="type">Text</span>(fruit)</span><br><span class="line">  &#125;</span><br><span class="line">&#125; label: &#123;</span><br><span class="line">  <span class="type">Text</span>(<span class="string">&quot;Picker&quot;</span>)</span><br><span class="line">&#125;.pickerStyle(.wheel) <span class="comment">// 使用此方法切换选择风格</span></span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3n2vebx0zj214s0mijv7.jpg"></image></pre>
</details>

<h4 id="DatePicker"><a href="#DatePicker" class="headerlink" title="DatePicker"></a>DatePicker</h4><p>系统内置的时间选择器</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DatePicker</span>(<span class="string">&quot;选择日期&quot;</span>, selection: <span class="variable">$selectDate</span>, displayedComponents: .date)</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3nr7v7zu9j214p0mdjvb.jpg"></image></pre>
</details>

<h4 id="Toggle"><a href="#Toggle" class="headerlink" title="Toggle"></a>Toggle</h4><p>类似于UISwitch,用于开关选择</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Toggle</span>(<span class="string">&quot;开关&quot;</span>, isOn: <span class="variable">$open</span>)</span><br><span class="line">.onChange(of: <span class="keyword">open</span>) &#123; newValue <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;切换了开关状态&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3o0cr0v3mj214q0mdmz8.jpg"></image></pre>
</details>

<h4 id="Slider"><a href="#Slider" class="headerlink" title="Slider"></a>Slider</h4><p>Slider相当于UIKit中的UISlider，通过移动滑杆实现指定区域和间隔的数值的选择。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Slider</span>(value: <span class="variable">$opacity</span>, in: <span class="number">0.1</span> <span class="operator">...</span> <span class="number">1.0</span>, step: <span class="number">0.05</span>).accentColor(.red)</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3p7s7u4plj214v0mf0vu.jpg"></image></pre>
</details>

<h4 id="Stepper"><a href="#Stepper" class="headerlink" title="Stepper"></a>Stepper</h4><p>步进选择器</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Stepper</span>(<span class="string">&quot;有限的选择数量&quot;</span>, value: <span class="variable">$value</span>, in: <span class="operator">-</span><span class="number">1</span> <span class="operator">...</span> <span class="number">5</span>, step: <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3p82b0ae5j214r0mhace.jpg"></image></pre>
</details>

<h3 id="Alerts"><a href="#Alerts" class="headerlink" title="Alerts"></a>Alerts</h3><h4 id="Alert"><a href="#Alert" class="headerlink" title="Alert"></a>Alert</h4><p>AlertView将被废弃,被.alert方法替代</p>
<p>swiftUI给VIew增加了.alert的扩展,给定一个绑定的值,当这个值发生变化的时候(true),触发Alert的事件。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.alert(<span class="string">&quot;Alert Title&quot;</span>, isPresented: <span class="variable">$isPresented1</span>, actions: &#123;</span><br><span class="line">    <span class="type">Button</span>(<span class="string">&quot;OK&quot;</span>)&#123;</span><br><span class="line">        <span class="comment">// button点击事件</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;, message: &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;一个选择项的Alert&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>当action中的button数量不同时会自动切换alert的显示格式</p>
<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3pcgv2l0dj213s0mgjuh.jpg"></image></pre>
</details>

<h4 id="ActionSheet"><a href="#ActionSheet" class="headerlink" title="ActionSheet"></a>ActionSheet</h4><p>ActionSheet将被废弃,被.confirmationDialog替代</p>
<p>SwiftUI给VIew增加了.confirmationDialog的扩展,给定一个绑定的值,当这个值发生变化的时候(true),触发ActionSheet的事件。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.confirmationDialog(<span class="string">&quot;选择你需要的选项&quot;</span>, isPresented: <span class="variable">$isPresented</span>) &#123;</span><br><span class="line">    <span class="type">Button</span>(<span class="string">&quot;Update&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">// choose update</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">Button</span>(<span class="string">&quot;Delete&quot;</span>, role: .destructive) &#123;</span><br><span class="line">        <span class="comment">// choose delete</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Button</span>(<span class="string">&quot;Cancel&quot;</span>, role:  .cancel) &#123;</span><br><span class="line">        <span class="comment">// choose cancel</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24egy1h3pctoaj0pj213k0mfaco.jpg"></image></pre>
</details>

<h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3><p>Image,类似于UIImageView,相对于UIimageview,Image控件可以更加简单的设置圆角,边框,阴影等属性。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(<span class="string">&quot;stmarylake&quot;</span>)</span><br><span class="line">.resizable() <span class="comment">// 必须先设置可以重设尺寸才可以改变图片原始尺寸</span></span><br><span class="line">.frame(width: <span class="number">100</span>, height: <span class="number">100</span>, alignment: .center)</span><br><span class="line">.clipShape(<span class="type">Rectangle</span>()) <span class="comment">// 边缘切割</span></span><br><span class="line">.overlay(<span class="type">Rectangle</span>().stroke(.white, lineWidth: <span class="number">4</span>), alignment: .bottom)<span class="comment">// 覆盖一个等大小的方块增加4的宽度的stroke用来做边框</span></span><br><span class="line">.shadow(radius: <span class="number">10</span>)<span class="comment">// 阴影</span></span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3jk79vi59j214p0mf76j.jpg"></image></pre>
</details>

<h3 id="WebImage"><a href="#WebImage" class="headerlink" title="WebImage"></a>WebImage</h3><p>SwiftUI中的VIew控件可以控制其生命周期,在onAppear的时候进行URL图片下载,下载成功后替换image即可。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Image</span>(uiImage: baseImage)</span><br><span class="line">.resizable()</span><br><span class="line">.frame(height: <span class="number">200</span>)</span><br><span class="line">.aspectRatio(contentMode: .fit)</span><br><span class="line">.onAppear &#123;</span><br><span class="line">    downloadImageWithURL(url: url)</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">downloadImageWithURL</span>(<span class="params">url</span>: <span class="type">String</span>?) &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> urlStr <span class="operator">=</span> url, <span class="keyword">let</span> url <span class="operator">=</span> <span class="type">URL</span>(string: urlStr) <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">  <span class="type">SwiftUIDemoHelper</span>.defult.downLoadImageWithURL(url: url) &#123; receivedSize, totalSize <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">let</span> progress <span class="operator">=</span> <span class="type">Float</span>(receivedSize) <span class="operator">/</span> <span class="type">Float</span>(totalSize)</span><br><span class="line">      downloadTaskProgress <span class="operator">=</span> progress</span><br><span class="line">  &#125; completion: &#123; res <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">switch</span> res &#123;</span><br><span class="line">      <span class="keyword">case</span> .success(<span class="keyword">let</span> img):</span><br><span class="line">          baseImage <span class="operator">=</span> img</span><br><span class="line">          downloadTaskProgress <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">      <span class="keyword">case</span> .failure(<span class="keyword">_</span>):</span><br><span class="line">          downloadError <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3uxv5n357j213q0natdv.jpg"></image></pre>
</details>

<p>当然可以使用kf图片库来进行网络图片的下载和缓存管理。</p>
<details>
<summary><font color=gray>点击查看长时间下载的加载效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3uxr4o7zbg20oo1hcx6p.gif" height = 400></image></pre>
</details>

<h3 id="Webview"><a href="#Webview" class="headerlink" title="Webview"></a>Webview</h3><p>SwiftUI没有再封装一套新的Webview容器,直接桥接WKWebView即可。</p>
<p>如何和UIKit进行桥接参考后续桥接部分。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> WebKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WebviewDemo</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> url: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;https://www.baidu.com&quot;</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> pageTitle: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;Webview&quot;</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">       <span class="type">SWWkWebview</span>(url: <span class="variable">$url</span>, pageTitle: <span class="variable">$pageTitle</span>)</span><br><span class="line">            .navigationTitle(pageTitle)</span><br><span class="line">            .navigationBarTitleDisplayMode(.inline)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SWWkWebview</span>: <span class="title class_ inherited__">UIViewRepresentable</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">UIViewType</span> <span class="operator">=</span> <span class="type">WKWebView</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> url: <span class="type">String</span></span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> pageTitle: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">WKWebView</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> view <span class="operator">=</span> <span class="type">WKWebView</span>()</span><br><span class="line">        view.navigationDelegate <span class="operator">=</span> context.coordinator</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> url <span class="operator">=</span> <span class="type">URL</span>(string: url) &#123;</span><br><span class="line">            view.load(<span class="type">URLRequest</span>(url: url))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIView</span>(<span class="keyword">_</span> <span class="params">uiView</span>: <span class="type">WKWebView</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> val <span class="operator">=</span>  <span class="type">Coordinator</span>()</span><br><span class="line">        val.updateTitle <span class="operator">=</span> &#123; title <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.pageTitle <span class="operator">=</span> title</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span>, <span class="title class_ inherited__">WKNavigationDelegate</span> &#123;</span><br><span class="line">       </span><br><span class="line">        <span class="keyword">var</span> updateTitle: ((<span class="type">String</span>) -&gt; <span class="type">Void</span>)<span class="operator">?</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">webView</span>(<span class="keyword">_</span> <span class="params">webView</span>: <span class="type">WKWebView</span>, <span class="params">didFinish</span> <span class="params">navigation</span>: <span class="type">WKNavigation</span>!) &#123;</span><br><span class="line">            webView.evaluateJavaScript(<span class="string">&quot;document.title&quot;</span>) &#123; (result, error) <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">let</span> title: <span class="type">String</span> <span class="operator">=</span> <span class="type">String</span>(describing: result <span class="operator">??</span> <span class="string">&quot;&quot;</span>)</span><br><span class="line">                <span class="keyword">self</span>.updateTitle<span class="operator">?</span>(title)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3uqhsiluvj213m0nc42w.jpg"></image></pre>
</details>

<hr>
<h2 id="桥接UIKit"><a href="#桥接UIKit" class="headerlink" title="桥接UIKit"></a>桥接UIKit</h2><p>SwiftUI可以自由的和当前项目中的framework协作，不论你是UIKit还是APPKit或者是WatchKit。这里我们简单说下如何桥接UIKit。</p>
<h3 id="UIViewRepresentable"><a href="#UIViewRepresentable" class="headerlink" title="UIViewRepresentable"></a>UIViewRepresentable</h3><p>有一些View还未被SwiftUI原生实现，需要从UIKit中桥接而来，例如前面的<a href="#Webview">WebviewDemo</a>。当然一些自己封装的View或者三方库View均可桥接到SwiftUI中展示。当我们需要在SwiftUI使用UIKit中的View时，我们需要创建一个实现了UIViewRepresentable协议的结构体作为我们的桥接View。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">UIViewRepresentable</span> : <span class="title class_ inherited__">View</span> <span class="keyword">where</span> <span class="title class_ inherited__">Self</span>.<span class="title class_ inherited__">Body</span> == <span class="title class_ inherited__">Never</span> &#123;</span><br><span class="line">    <span class="comment">/// 首先需要确定你要桥接的View的类型</span></span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">UIViewType</span> : <span class="type">UIView</span></span><br><span class="line">    <span class="comment">/// 必须实现的协议，系统在初始化结构体的时候会初始化你的View</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="keyword">Self</span>.<span class="type">Context</span>) -&gt; <span class="keyword">Self</span>.<span class="type">UIViewType</span></span><br><span class="line">    <span class="comment">/// 必须实现的协议，SwiftUI更新的时候会调用此方法让你的View同步更新</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIView</span>(<span class="keyword">_</span> <span class="params">uiView</span>: <span class="keyword">Self</span>.<span class="type">UIViewType</span>, <span class="params">context</span>: <span class="keyword">Self</span>.<span class="type">Context</span>)</span><br><span class="line">    <span class="comment">/// 非必须实现的协议，相当于 UIView 的 deinit 方法，可以在其中做一些诸如删除通知 observer，停止 timer 等清理工作</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">dismantleUIView</span>(<span class="keyword">_</span> <span class="params">uiView</span>: <span class="keyword">Self</span>.<span class="type">UIViewType</span>, <span class="params">coordinator</span>: <span class="keyword">Self</span>.<span class="type">Coordinator</span>)</span><br><span class="line">    <span class="comment">/// 协调器，当前结构体从UIKit中获取数据的途径，一般用来实现UIKit View 的代理</span></span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Coordinator</span> <span class="operator">=</span> <span class="type">Void</span></span><br><span class="line">    <span class="comment">/// 创建一个协调器，用来连接SwiftUI和UIKit，makeUIView之前就会调用</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="keyword">Self</span>.<span class="type">Coordinator</span></span><br><span class="line">    <span class="comment">/// 存储一些数据的上下文</span></span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Context</span> <span class="operator">=</span> <span class="type">UIViewRepresentableContext</span>&lt;<span class="keyword">Self</span>&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>桥接过程的生命周期为：</p>
<p><img src="https://cdn.zcx.info/e6c9d24ely1h3x76m90gnj20b80buglq.jpg" alt="4"></p>
<p>其中updateUIView方法会随着View的刷新调用多次。</p>
<h3 id="UIViewControllerRepresentable"><a href="#UIViewControllerRepresentable" class="headerlink" title="UIViewControllerRepresentable"></a>UIViewControllerRepresentable</h3><p>类似于桥接UIView，SwiftUI也给出了桥接UIViewController的方式</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">protocol</span> <span class="title class_">UIViewControllerRepresentable</span> : <span class="title class_ inherited__">View</span> <span class="keyword">where</span> <span class="title class_ inherited__">Self</span>.<span class="title class_ inherited__">Body</span> == <span class="title class_ inherited__">Never</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">UIViewControllerType</span> : <span class="type">UIViewController</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIViewController</span>(<span class="params">context</span>: <span class="keyword">Self</span>.<span class="type">Context</span>) -&gt; <span class="keyword">Self</span>.<span class="type">UIViewControllerType</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIViewController</span>(<span class="keyword">_</span> <span class="params">uiViewController</span>: <span class="keyword">Self</span>.<span class="type">UIViewControllerType</span>, <span class="params">context</span>: <span class="keyword">Self</span>.<span class="type">Context</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="keyword">Self</span>.<span class="type">Coordinator</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Context</span> <span class="operator">=</span> <span class="type">UIViewControllerRepresentableContext</span>&lt;<span class="keyword">Self</span>&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从实现上来看桥接View和ViewController都是同一种实现方式，都借助了生成一个协调器Coordinator来连接二者。</p>
<hr>
<h2 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a>数据流</h2><p>SwiftUI的设计理念是，所有数据<strong>有且仅有一个</strong>数据源。物理内存中仅仅保存一份数据,其余地方均引用其指针地址。</p>
<h3 id="State"><a href="#State" class="headerlink" title="@State"></a>@State</h3><p>SwiftUI中大量使用结构体<code>Struct</code>,结构体中的变量一般是不能修改的,但是在View层级中会随着用户操作或者其他条件触发数据的变化,这个时候我们该如何让数据变化的同时界面跟随刷新变化呢。</p>
<p>如果视图需要存储它可以修改的数据，请使用<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/state"><code>State</code></a>属性包装器声明一个变量。</p>
<p>例如我们在开关Demo中使用了用<code>@State</code>包裹着的<code>open</code>属性,当触发开关onchange方法的时候会直接改变open属性的值。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ToggleDemo</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> <span class="keyword">open</span>: <span class="type">Bool</span> <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Form</span>&#123;</span><br><span class="line">            <span class="type">Toggle</span>(<span class="string">&quot;开关&quot;</span>, isOn: <span class="variable">$open</span>)</span><br><span class="line">                .onChange(of: <span class="keyword">open</span>) &#123; newValue <span class="keyword">in</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;切换了开关状态&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;开关状态: <span class="subst">\(<span class="keyword">open</span>.description)</span>&quot;</span>)</span><br><span class="line">        &#125;.navigationTitle(<span class="string">&quot;Toggle&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通俗的理解为struct内的属性都是不可变的,但是当你的View的body想要监听某个属性的时候可以给这个属性增加@State修饰符,这样的话就可以在struct内部直接修改此变量而不再使用mutating,同时当此变量发生改变的时候会触发View的重载和刷新。</p>
<p>在State单词的语境下理解这个修饰符会更容易–状态变量。实质为当结构体中的属性发生了改变,Swift会创建一个新的Struct来替换原来的Struct。而@State 能够发现这种变化，并自动重新加载视图。</p>
<p>SwiftUI在别的存储位置专门存放使用@State修饰的变量,来绕过结构体的限制。</p>
<p>注意,这种用法破坏了常识中的结构体的规则,@State 是专门为存储在一个结构体中的简单属性而设计的,所以尽量将使用@State修饰的变量设置为私有的(private)。</p>
<p>值得一提的是SwiftUI支持在任何线程安全地修改@State修饰的变量。</p>
<h3 id="Binding"><a href="#Binding" class="headerlink" title="@Binding"></a>@Binding</h3><p>由上一节的@State我们可以做到数据源变化的时候刷新View,当然有时候会出现一些相反的场景,比如一些View的操作变化产生了新的数据需要回传给另一个View显示,例如之前的WebviewDemo中桥接Wkwebview的SWWkWebview类。</p>
<p>在Wkwebview的WKNavigationDelegate代理中发现Webview加载完毕之后执行JS代码来获取页面的标题,然后反向传递到上层页面的导航条上显示。</p>
<p>这种情况适合使用@Binding修饰符来修饰属性让SwiftUI知晓这里需要使用指针传递,而非值传递(Swift中的struct内属性赋值默认是值传递)。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">WebviewDemo</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> url: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;https://www.36kr.com&quot;</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> pageTitle: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;Webview&quot;</span> <span class="comment">// 默认的标题,状态变量</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">       <span class="type">SWWkWebview</span>(url: <span class="variable">$url</span>, pageTitle: <span class="variable">$pageTitle</span>)<span class="comment">// 注意@Binding的属性需要使用$符号来传递指针值</span></span><br><span class="line">            .navigationTitle(pageTitle)<span class="comment">// pageTitle改变时会更新导航栏标题</span></span><br><span class="line">            .navigationBarTitleDisplayMode(.inline)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SWWkWebview</span>: <span class="title class_ inherited__">UIViewRepresentable</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">UIViewType</span> <span class="operator">=</span> <span class="type">WKWebView</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">// @Binding修饰的属性,说明这个属性需要指针传递,不能使用值传递</span></span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> url: <span class="type">String</span></span><br><span class="line">    <span class="comment">// 指针传递才能够做到不增加别的操作就能直接改变外部环境的属性值</span></span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> pageTitle: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">WKWebView</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> view <span class="operator">=</span> <span class="type">WKWebView</span>()</span><br><span class="line">        view.navigationDelegate <span class="operator">=</span> context.coordinator</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> url <span class="operator">=</span> <span class="type">URL</span>(string: url) &#123;</span><br><span class="line">            view.load(<span class="type">URLRequest</span>(url: url))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIView</span>(<span class="keyword">_</span> <span class="params">uiView</span>: <span class="type">WKWebView</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeCoordinator</span>() -&gt; <span class="type">Coordinator</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> val <span class="operator">=</span>  <span class="type">Coordinator</span>()</span><br><span class="line">        val.updateTitle <span class="operator">=</span> &#123; title <span class="keyword">in</span></span><br><span class="line">            <span class="comment">//这里更新pageTitle指针指向的属性的值</span></span><br><span class="line">            <span class="keyword">self</span>.pageTitle <span class="operator">=</span> title</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Coordinator</span>: <span class="title class_ inherited__">NSObject</span>, <span class="title class_ inherited__">WKNavigationDelegate</span> &#123;</span><br><span class="line">       </span><br><span class="line">        <span class="keyword">var</span> updateTitle: ((<span class="type">String</span>) -&gt; <span class="type">Void</span>)<span class="operator">?</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">webView</span>(<span class="keyword">_</span> <span class="params">webView</span>: <span class="type">WKWebView</span>, <span class="params">didFinish</span> <span class="params">navigation</span>: <span class="type">WKNavigation</span>!) &#123;</span><br><span class="line">            webView.evaluateJavaScript(<span class="string">&quot;document.title&quot;</span>) &#123; (result, error) <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">let</span> title: <span class="type">String</span> <span class="operator">=</span> <span class="type">String</span>(describing: result <span class="operator">??</span> <span class="string">&quot;&quot;</span>)</span><br><span class="line">                <span class="comment">// 这里每次加载页面都获取页面的标题,然后执行block进行SWWkWebview结构体的更新</span></span><br><span class="line">                <span class="keyword">self</span>.updateTitle<span class="operator">?</span>(title)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然@Binding的链接是双向的,不仅可以从下向上修改数据,在上层View修改的下层View绑定的数据属性的时候,下层View也会受到影响。</p>
<p>可以看到数据流向图:</p>
<p><img src="https://docs-assets.developer.apple.com/published/d98251c2fac9fc4f6843be1e4836cb93/Managing-User-Interface-State-1@2x.png" alt="基本数据流向"></p>
<p>首先我们在上层View中存在一个@State修饰的状态变量,上层View会观察此变量的变化随之刷新界面,相应刷新的View可能是另外一个下层VIew,不过这个并不影响既定的刷新规则。这种数据流向为单向绑定。</p>
<p>其次我们可以把状态变量的指针传递给下层@Binding修饰的属性变量,当任何一方修改此属性的时候都会触发观察者更新全部的View。这种数据流向为双向绑定。</p>
<p>从上图可以观察到,当使用@State属性来修饰的时候可以认为此属性为值的真实来源,当使用@Binding修饰属性的时候可以认为此属性为真实值的指针。</p>
<p>类似的当看到带有State单词的修饰符时都可以认为当前属性为值的真实来源，且当前View是这个属性的原始持有者。</p>
<h3 id="ObservableObject、-Published、-StateObject"><a href="#ObservableObject、-Published、-StateObject" class="headerlink" title="@ObservableObject、@Published、@StateObject"></a>@ObservableObject、@Published、@StateObject</h3><p>虽然Swift中推荐使用Struct,但是Class的使用还是不可缺少的一环。相比于结构体的值传递,class默认进行的就是指针传递。那么指针传递的Class是否就自动获得了类似于@State和@Binding的功能呢?</p>
<p>答案是NO</p>
<p>SwiftUI中并不会因为你传递进来的是一个类变量就默认自动刷新显示。想要达到这样的效果必须使当前类满足ObservableObject协议。</p>
<p>ObservableObject字面意思,可观察对象。在类中可以添加@Published修饰符来告诉SwiftUI这个类中的这个属性可以发布订阅。</p>
<p>例如我们现在有一个可以显示用户信息的文本可一个点击一下增加一岁的按钮：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name <span class="operator">=</span> <span class="string">&quot;Apple&quot;</span></span><br><span class="line">    <span class="keyword">var</span> age <span class="operator">=</span> <span class="number">15</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CustomViews</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> user <span class="operator">=</span> <span class="type">User</span>()</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span>&#123;</span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;当前的用户名:<span class="subst">\(user.name)</span>&quot;</span>)</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;当前的用户年龄:<span class="subst">\(user.age)</span>岁&quot;</span>)</span><br><span class="line">                <span class="type">Button</span>(<span class="string">&quot;一年过去了&quot;</span>) &#123;</span><br><span class="line">                    user.age <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;一年后的年龄:<span class="subst">\(user.age)</span>&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationTitle(<span class="string">&quot;自定义view组件&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3w250asb2j213u0mqwgy.jpg"></image></pre>
</details>

<p>可以看到我们点了很多次按钮,内存中的age字段已经变成了25,界面上却依旧显示为原始的值,这是因为User类是不可观察的,所以当User中的字段发生改变的时候不能触发页面的刷新.</p>
<p>现在我们为User类增加可观察属性</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>: <span class="title class_ inherited__">ObservableObject</span> &#123;</span><br><span class="line">    <span class="meta">@Published</span> <span class="keyword">var</span> name <span class="operator">=</span> <span class="string">&quot;Apple&quot;</span></span><br><span class="line">    <span class="meta">@Published</span> <span class="keyword">var</span> age <span class="operator">=</span> <span class="number">15</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CustomViews</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="comment">// 以前使用@ObservableObject的时候有user属性被异常释放的风险,改为使用@StateObject修饰符</span></span><br><span class="line">    <span class="meta">@StateObject</span> <span class="keyword">private</span> <span class="keyword">var</span> user <span class="operator">=</span> <span class="type">User</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span>&#123;</span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;当前的用户名:<span class="subst">\(user.name)</span>&quot;</span>)</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;当前的用户年龄:<span class="subst">\(user.age)</span>岁&quot;</span>)</span><br><span class="line">                <span class="type">Button</span>(<span class="string">&quot;一年过去了&quot;</span>) &#123;</span><br><span class="line">                    user.age <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;一年后的年龄:<span class="subst">\(user.age)</span>&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationTitle(<span class="string">&quot;自定义view组件&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<details>
<summary><font color=gray>点击查看运行效果</font> </summary>
  <pre><image src="https://cdn.zcx.info/e6c9d24ely1h3w27hniv2j213o0luad5.jpg"></image></pre>
</details>

<p>可以看到随着我们的点击增加user的age字段值,界面上显示的年龄文字也随之增加.</p>
<p>当然你需要给可观察的对象增加**@StateObject**修饰符</p>
<p><strong>为什么不使用@ObservedObject修饰符呢?</strong></p>
<ol>
<li><p>这将确保 User 实例在视图更新时不会被破坏。以前可能已经使用 @ObservedObject 来获得相同的结果，但这是有风险的。有时 @ObservedObject 可能会意外释放它正在存储的对象，因为它不是设计为最终的真相来源目的，但 @StateObject 就不会发生这种情况，因此应该改用它。</p>
</li>
<li><p>@StateObject 和 @ObservedObject 之间有一个重要的区别，即<strong>所有权</strong>，哪个视图创建了对象，哪个视图只是在监视它。规则是这样的：首先创建对象的视图必须使用**@StateObject**，告诉 SwiftUI 它是数据的所有者并负责保持它的活动，所有其它视图都必须使用 <strong>@ObservedObject</strong> 来告诉 SwiftUI，它们想要观察对象的变化但不直接拥有它。即每个对象应该只使用一次 @StateObject，它应该在负责创建对象的任何视图中，共享对象的所有其它视图都应使用@ObservedObject。</p>
</li>
</ol>
<p><strong>思考1: 我们能对Class使用@State修饰吗?</strong></p>
<p>可以,只不过使用@State修饰的时候只有当前值发生变化的时候才会触发View变化,当被修饰的是Class类型的变量时,类内容的属性改变并不能改变当前类的值(指针).所以必须触发类的当前值改变的时候才能和观察者产生一样的效果.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name <span class="operator">=</span> <span class="string">&quot;Apple&quot;</span></span><br><span class="line">    <span class="keyword">var</span> age <span class="operator">=</span> <span class="number">15</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CustomViews</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">var</span> user <span class="operator">=</span> <span class="type">User</span>()</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span>&#123;</span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;当前的用户名:<span class="subst">\(user.name)</span>&quot;</span>)</span><br><span class="line">                <span class="type">Text</span>(<span class="string">&quot;当前的用户年龄:<span class="subst">\(user.age)</span>岁&quot;</span>)</span><br><span class="line">                <span class="type">Button</span>(<span class="string">&quot;一年过去了&quot;</span>) &#123;</span><br><span class="line">                  <span class="comment">// 直接生成新的类,或者做类的深拷贝后改变age数值</span></span><br><span class="line">                    <span class="keyword">let</span> userB <span class="operator">=</span> <span class="type">User</span>()</span><br><span class="line">                    userB.name <span class="operator">=</span> user.name</span><br><span class="line">                    userB.age <span class="operator">=</span> user.age <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">                    user <span class="operator">=</span> userB</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationTitle(<span class="string">&quot;自定义view组件&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>思考2: 我们可以对结构体使用@StateObject吗?</strong></p>
<p>很遗憾不能, 因为@StateObject修饰符必须要求属性满足ObservableObject协议,而非class类型不能遵循协议.</p>
<h3 id="EnvironmentObject"><a href="#EnvironmentObject" class="headerlink" title="@EnvironmentObject"></a>@EnvironmentObject</h3><p>思考一种场景，如果您有视图 A，并且视图 A 有一些视图 E 想要的数据，使用@ObservedObject 视图 A 需要将对象交给视图 B，视图 B 将把它交给视图 C，然后是视图 D，最后是视图 E，所有中间视图都需要发送对象，即使它们实际上并没有需要它。</p>
<p>这个时候我们可以使用@EnvironmentObject ，视图 A 可以创建一个对象并将其放入环境中；然后，其中的任何视图都可以随时通过请求访问该环境对象，而不必显式传递它，这样会使我们的代码更简单。</p>
<p>例如之前的Demo种的列表数据:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SwiftUIDemoApp</span>: <span class="title class_ inherited__">App</span> &#123;</span><br><span class="line">    <span class="meta">@StateObject</span> <span class="keyword">private</span> <span class="keyword">var</span> features <span class="operator">=</span> <span class="type">FeatureInfoModel</span>()</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="type">WindowGroup</span> &#123;</span><br><span class="line">            <span class="type">DemoHomeView</span>().environmentObject(features)<span class="comment">//这里向环境变量中添加了一个FeatureInfoModel</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FeatureListHomeView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> feature: <span class="type">FeatureInfoModel</span> <span class="comment">//这个view从环境变量中获取了FeatureInfoModel</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">      <span class="type">NavigationView</span>&#123;</span><br><span class="line">          <span class="type">List</span> &#123;</span><br><span class="line">              <span class="type">ForEach</span>(feature.demoFeatures.featureSections, id: \.<span class="keyword">self</span>) &#123; sec <span class="keyword">in</span></span><br><span class="line">                  <span class="type">Section</span>(sec.featureSectionName) &#123;</span><br><span class="line">                      <span class="type">ForEach</span>(sec.featureList, id: \.<span class="keyword">self</span>) &#123; item <span class="keyword">in</span></span><br><span class="line">                          <span class="type">NavigationLink</span> &#123;</span><br><span class="line">                              getDestinationViews(featureItem: item)</span><br><span class="line">                          &#125; label: &#123;</span><br><span class="line">                              <span class="type">DemoRowView</span>(title: item.featureName, subTitle: item.featureDesc)</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;.onDelete &#123; offset <span class="keyword">in</span></span><br><span class="line">                          deleteRow(offset: offset, from: sec)</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;.listStyle(.in<span class="keyword">set</span>)</span><br><span class="line">          .navigationTitle(<span class="string">&quot;基础控件&quot;</span>)</span><br><span class="line">          .navigationBarTitleDisplayMode(.large)</span><br><span class="line">          .toolbar&#123;</span><br><span class="line">              <span class="type">EditButton</span>()</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很明显DemoHomeView和FeatureListHomeView中间间隔了一些其他View，类似于全局变量可以直接读取使用。</p>
<p>通常EnvironmentObject用于整个应用程序中一些View都依赖和共享的数据，因为所有的视图都指向同一个模型，当被修饰的属性发生变化时，所有的视图都会立即更新，排除了应用程序的不同部分出现不同步的风险。</p>
<h2 id="应用程序行为控制"><a href="#应用程序行为控制" class="headerlink" title="应用程序行为控制"></a>应用程序行为控制</h2><h3 id="UIApplicationDelegate"><a href="#UIApplicationDelegate" class="headerlink" title="UIApplicationDelegate"></a>UIApplicationDelegate</h3><p>作为一个完整的APP，开发者应该可以控制APP的完整生命周期，这个时候我们需要一个<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate"><code>UIApplicationDelegate</code></a>类型的对象来承载App生命周期内各种行为的相应。</p>
<p>但是创建SwiftUI项目的时候Xcode并没有给我们默认创建Applegate.swift文件。</p>
<p>如果我们需要实现UIApplicationDelegate方法，我们需要手动创建Applegate.swift文件，并且让我们的Applegate类遵循NSObject协议和UIApplicationDelegate协议，然后实现我们需要的方法。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">APPDelegate</span>: <span class="title class_ inherited__">NSObject</span>, <span class="title class_ inherited__">UIApplicationDelegate</span>, <span class="title class_ inherited__">ObservableObject</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">application</span>(<span class="keyword">_</span> <span class="params">application</span>: <span class="type">UIApplication</span>,</span><br><span class="line">                     <span class="params">didFinishLaunchingWithOptions</span> <span class="params">launchOptions</span>: [<span class="type">UIApplication</span>.<span class="params">LaunchOptionsKey</span> : <span class="keyword">Any</span>]<span class="operator">?</span> <span class="operator">=</span> <span class="literal">nil</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;didFinishLaunchingWithOptions&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// SwiftUI中一些方法不能触发</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">applicationDidReceiveMemoryWarning</span>(<span class="keyword">_</span> <span class="params">application</span>: <span class="type">UIApplication</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;log-DidReceiveMemoryWarning&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">applicationDidBecomeActive</span>(<span class="keyword">_</span> <span class="params">application</span>: <span class="type">UIApplication</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;log-applicationDidBecomeActive&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">applicationDidEnterBackground</span>(<span class="keyword">_</span> <span class="params">application</span>: <span class="type">UIApplication</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;log-applicationDidEnterBackground&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现了代理方法后，我们还需要告诉SwiftUI在哪里增加我们的代理，在@main入口的struct中添加@UIApplicationDelegateAdaptor标记，SwiftUI会自动识别我们的代理类，并在合适的时机调用对应的代理方法。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SwiftUIDemoApp</span>: <span class="title class_ inherited__">App</span> &#123;</span><br><span class="line">   </span><br><span class="line">  <span class="meta">@UIApplicationDelegateAdaptor</span> <span class="keyword">private</span> <span class="keyword">var</span> appdelegate: <span class="type">APPDelegate</span></span><br><span class="line">    <span class="comment">//@UIApplicationDelegateAdaptor(APPDelegate.self) var appdelegate 这个写法也可以</span></span><br><span class="line">   <span class="operator">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>比较方便的是如果你的APPDelegate类遵循了ObservableObject协议，SwiftUI会自动把@UIApplicationDelegateAdaptor修饰的属性放到全局环境变量里去，例如这里我们并没有声明全局环境变量，但是在下层的View中依旧可以使用全局环境变量获取。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">FeatureListHomeView</span>: <span class="title class_ inherited__">View</span> &#123;  </span><br><span class="line"> <span class="comment">// 这里去获取环境变量</span></span><br><span class="line"> <span class="meta">@EnvironmentObject</span> <span class="keyword">var</span> appdelegate: <span class="type">APPDelegate</span></span><br><span class="line"> <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">NavigationView</span> &#123;</span><br><span class="line">      <span class="operator">...</span></span><br><span class="line">    &#125;.onAppear &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我在App内部的view获取到了全局的appdelegate中的name属性<span class="subst">\(appdelegate.name)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是要注意一个问题，随着API的更新，有些代理方法不再由UIApplicationDelegate调用。</p>
<p>例如App前后台切换的代理，iOS13以前，由UIApplicationDelegate来控制生命周期，iOS13以后，由UISceneDelegate来控制生命周期。在iOS 13之后为了解决iPadOS展示多窗口的问题，用UIScene替代了之前UIWindow来管理视图。</p>
<p>iOS14以后Apple又给SwiftUI提供了更优雅的API来显示和控制Scene。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SwiftUIDemoApp</span>: <span class="title class_ inherited__">App</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Environment</span>(\.scenePhase) <span class="keyword">var</span> scenePhase</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">      <span class="type">WindowGroup</span> &#123;</span><br><span class="line">          <span class="type">DemoHomeView</span>()</span><br><span class="line">      &#125;.onChange(of: scenePhase) &#123; newValue <span class="keyword">in</span></span><br><span class="line">          <span class="keyword">switch</span> newValue &#123;</span><br><span class="line">          <span class="keyword">case</span> .active:</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;active&quot;</span>)</span><br><span class="line">          <span class="keyword">case</span> .background:</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;background&quot;</span>)</span><br><span class="line">          <span class="keyword">case</span> .inactive:</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;inactive&quot;</span>)</span><br><span class="line">          <span class="keyword">@unknown</span> <span class="keyword">default</span>:</span><br><span class="line">              <span class="keyword">break</span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UIWindowSceneDelegate"><a href="#UIWindowSceneDelegate" class="headerlink" title="UIWindowSceneDelegate"></a>UIWindowSceneDelegate</h3><p>多窗口管理和App代理类似，平常用的较少。</p>
<p>如果使用了场景委托UIWindowSceneDelegate，也需要自行创建委托文件SceneDelegate。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SceneDelegate</span>: <span class="title class_ inherited__">NSObject</span>, <span class="title class_ inherited__">UIWindowSceneDelegate</span>, <span class="title class_ inherited__">ObservableObject</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">windowScene</span>( <span class="keyword">_</span> <span class="params">windowScene</span>: <span class="type">UIWindowScene</span>,<span class="params">performActionFor</span> <span class="params">shortcutItem</span>: <span class="type">UIApplicationShortcutItem</span> ) <span class="keyword">async</span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="comment">// Do something with the shortcut...</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后直接在Appdelegate类中的方法中返回场景委托类即可。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">application</span>(<span class="keyword">_</span> <span class="params">application</span>: <span class="type">UIApplication</span>, <span class="params">configurationForConnecting</span> <span class="params">connectingSceneSession</span>: <span class="type">UISceneSession</span>, <span class="params">options</span>: <span class="type">UIScene</span>.<span class="type">ConnectionOptions</span>) -&gt; <span class="type">UISceneConfiguration</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> configuration <span class="operator">=</span> <span class="type">UISceneConfiguration</span>(name: <span class="literal">nil</span>,sessionRole: connectingSceneSession.role)</span><br><span class="line">  <span class="keyword">if</span> connectingSceneSession.role <span class="operator">==</span> .windowApplication &#123;</span><br><span class="line">      configuration.delegateClass <span class="operator">=</span> <span class="type">SceneDelegate</span>.<span class="keyword">self</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> configuration</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同样的，如果你的SceneDelegate类遵循了ObservableObject协议，SwiftUI会自动把当前类型的属性放到环境环境变量里去。</p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2022/11/05/iOS%E7%AD%BE%E5%90%8D%E6%9C%BA%E5%88%B6/"
      title="iOS签名机制"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        iOS签名机制
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2022/02/28/XCUITest%E6%8E%A2%E7%B4%A2/"
      title="XCUITest iOS自动化UI测试框架"
     >

    <p class="title-text">
      
        XCUITest iOS自动化UI测试框架
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>





    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 bruin<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
